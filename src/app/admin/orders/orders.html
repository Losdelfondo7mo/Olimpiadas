<div class="container mt-4">

  <!-- PENDIENTES -->
  <h2 class="text-primary"> Pedidos Pendientes</h2>
  <div *ngFor="let pedido of pendientes" class="pedido-card border border-primary mb-3 p-3">
    <h3>Pedido ID: {{ pedido.n_pedido }}</h3>
    <p><strong>Usuario ID:</strong> {{ pedido.usuario_id }}</p>
    <p><strong>Fecha:</strong> {{ pedido.fecha | date:'medium' }}</p>
    <p><strong>Total:</strong> $ {{ pedido.monto_total }}</p>

    <div *ngIf="pedido.detalles.length > 0; else noProductosPendiente">
      <strong>Productos:</strong>
      <ul>
        <li *ngFor="let detalle of pedido.detalles">
          {{ productosMap.get(detalle.producto_id)?.nombre || 'Producto desconocido' }} -
          Cantidad: {{ detalle.cantidad }} -
          Precio unitario: ${{ detalle.precio_unitario }}
        </li>
      </ul>
    </div>
    <ng-template #noProductosPendiente>
      <p><em>No hay productos disponibles para este pedido.</em></p>
    </ng-template>

    <button class="btn btn-success me-2" (click)="confirmar(pedido.id)">Confirmar</button>
    <button class="btn btn-danger" (click)="cancelar(pedido.id)">Cancelar</button>
  </div>

  <hr>

  <!-- APROBADOS -->
  <h2 class="text-success">Pedidos Aprobados</h2>
  <div *ngFor="let pedido of aprobados" class="pedido-card border border-success mb-3 p-3">
    <h3>Pedido ID: {{ pedido.n_pedido }}</h3>
    <p><strong>Usuario ID:</strong> {{ pedido.usuario_id }}</p>
    <p><strong>Fecha:</strong> {{ pedido.fecha | date:'medium' }}</p>
    <p><strong>Total:</strong> $ {{ pedido.monto_total }}</p>

    <div *ngIf="pedido.detalles.length > 0; else noProductosAprobado">
      <strong>Productos:</strong>
      <ul>
        <li *ngFor="let detalle of pedido.detalles">
          {{ productosMap.get(detalle.producto_id)?.nombre || 'Producto desconocido' }} -
          Cantidad: {{ detalle.cantidad }} -
          Precio unitario: ${{ detalle.precio_unitario }}
        </li>
      </ul>
    </div>
    <ng-template #noProductosAprobado>
      <p><em>No hay productos disponibles para este pedido.</em></p>
    </ng-template>
  </div>

  <hr>

  <!-- CANCELADOS -->
  <h2 class="text-secondary">Pedidos Cancelados</h2>
  <div *ngFor="let pedido of cancelados" class="pedido-card border border-secondary mb-3 p-3">
    <h3>Pedido ID: {{ pedido.n_pedido }}</h3>
    <p><strong>Usuario ID:</strong> {{ pedido.usuario_id }}</p>
    <p><strong>Fecha:</strong> {{ pedido.fecha | date:'medium' }}</p>
    <p><strong>Total:</strong> $ {{ pedido.monto_total }}</p>

    <div *ngIf="pedido.detalles.length > 0; else noProductosCancelado">
      <strong>Productos:</strong>
      <ul>
        <li *ngFor="let detalle of pedido.detalles">
          {{ productosMap.get(detalle.producto_id)?.nombre || 'Producto desconocido' }} -
          Cantidad: {{ detalle.cantidad }} -
          Precio unitario: ${{ detalle.precio_unitario }}
        </li>
      </ul>
    </div>
    <ng-template #noProductosCancelado>
      <p><em>No hay productos disponibles para este pedido.</em></p>
    </ng-template>
  </div>

</div>
